/**
 * w11k-flash - v0.1.0 - 2014-07-02
 * https://github.com/w11k/w11k-flash
 *
 * Copyright (c) 2014 WeigleWilczek GmbH
 */
"use strict";angular.module("w11k.flash",[]),angular.module("w11k.flash").factory("swfobject",function(a){return a.swfobject}),angular.module("w11k.flash").factory("w11kFlashRegistry",function(){var a="w11k-flash-id-",b=0,c={};return{getFlashId:function(){return a+b++},registerFlash:function(a,b){c[a]=b},unregisterFlash:function(a){delete c[a]},getFlash:function(a){return c[a]}}}),angular.module("w11k.flash").run(function(a,b){angular.isFunction(a.w11kFlashIsReady)===!1&&(a.w11kFlashIsReady=function(a){var c=b.getFlash(a);if(!angular.isDefined(c))throw new Error("unknown flashId");c.deferred.resolve(c.object)})}),angular.module("w11k.flash").run(function(a,b){angular.isFunction(a.w11kFlashCall)===!1&&(a.w11kFlashCall=function(a,c,d){var e=b.getFlash(a);if(angular.isDefined(e)){var f=e.element.scope(),g=f.$eval(c,d);return f.$apply(function(){}),g}throw new Error("unknown flashId")})}),angular.module("w11k.flash").constant("w11kFlashConfig",{templateUrl:"w11k-flash.tpl.html",swfObject:{minFlashVersion:"10.2.0",width:800,height:600,flashvars:{},params:{quality:"high",bgcolor:"#ffffff",allowfullscreen:"false",allowScriptAccess:"always",wmode:"opaque"},attributes:{align:"middle"}}}),angular.module("w11k.flash").directive("w11kFlash",function(a,b,c,d,e,f){return{restrict:"EA",templateUrl:d.templateUrl,link:function(b,e,g){var h=angular.element(e[0].querySelector(".w11k-flash-container")),i=angular.element(e[0].querySelector(".w11k-flash-element"));i.remove();var j=!1;b.$watch(g.w11kFlashVisible,function(a){a&&j===!1&&(k(),j=!0),a?(e.css("visibility","visible"),e.css("height","auto"),e.css("width","auto")):(e.css("visibility","hidden"),e.css("height","0"),e.css("width","0"))});var k=function(){var j=b.$eval(g.w11kFlash),k=f.getFlashId(),l=angular.extend({flashvars:{}},d.swfObject,j);if(l.flashvars.w11kFlashId=k,h.append(i),i.attr("id",k),a.hasFlashPlayerVersion(l.minFlashVersion)){i.css("min-height",l.height),i.css("min-width",l.width);var m=function(a){var d=c.defer();f.registerFlash(k,{deferred:d,object:a.ref,element:e}),b.$on("$destroy",function(){f.unregisterFlash(k)}),angular.isFunction(l.callback)&&l.callback(d.promise)};a.embedSWF(l.swfUrl,k,""+l.width,""+l.height,l.minFlashVersion,!1,l.flashvars,l.params,l.attributes,m)}}}}});