/**
 * w11k-flash - v0.1.3 - 2014-07-02
 * https://github.com/w11k/w11k-flash
 *
 * Copyright (c) 2014 WeigleWilczek GmbH
 */
"use strict";angular.module("w11k.flash",[]),angular.module("w11k.flash").factory("swfobject",["$window",function(a){return a.swfobject}]),angular.module("w11k.flash").factory("w11kFlashRegistry",[function(){var a="w11k-flash-id-",b=0,c={};return{getFlashId:function(){return a+b++},registerFlash:function(a,b){c[a]=b},unregisterFlash:function(a){delete c[a]},getFlash:function(a){return c[a]}}}]),angular.module("w11k.flash").run(["$window","w11kFlashRegistry",function(a,b){angular.isFunction(a.w11kFlashIsReady)===!1&&(a.w11kFlashIsReady=function(a){var c=b.getFlash(a);if(!angular.isDefined(c))throw new Error("unknown flashId");c.deferred.resolve(c.object)})}]),angular.module("w11k.flash").run(["$window","w11kFlashRegistry",function(a,b){angular.isFunction(a.w11kFlashCall)===!1&&(a.w11kFlashCall=function(a,c,d){var e=b.getFlash(a);if(angular.isDefined(e)){var f=e.element.scope(),g=f.$eval(c,d);return f.$apply(function(){}),g}throw new Error("unknown flashId")})}]),angular.module("w11k.flash").constant("w11kFlashConfig",{templateUrl:"w11k-flash.tpl.html",swfObject:{minFlashVersion:"14.0.0",width:800,height:600}}),angular.module("w11k.flash").directive("w11kFlash",["swfobject","$window","$q","w11kFlashConfig","$timeout","w11kFlashRegistry",function(a,b,c,d,e,f){var g=function(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},g(a[c],b[c])):a[c]=b[c];return a};return{restrict:"EA",templateUrl:d.templateUrl,link:function(b,e,h){var i=angular.element(e[0].querySelector(".w11k-flash-container")),j=angular.element(e[0].querySelector(".w11k-flash-element"));j.remove();var k=!1;b.$watch(h.w11kFlashVisible,function(a){a&&k===!1&&(l(),k=!0),a?(e.css("visibility","visible"),e.css("height","auto"),e.css("width","auto")):(e.css("visibility","hidden"),e.css("height","0"),e.css("width","0"))});var l=function(){var k=b.$eval(h.w11kFlash),l=f.getFlashId(),m={flashvars:{},params:{},attributes:{}};if(g(m,d.swfObject),g(m,k),m.flashvars.w11kFlashId=l,i.append(j),j.attr("id",l),a.hasFlashPlayerVersion(m.minFlashVersion)){j.css("min-height",m.height),j.css("min-width",m.width);var n=function(a){var d=c.defer();f.registerFlash(l,{deferred:d,object:a.ref,element:e}),b.$on("$destroy",function(){f.unregisterFlash(l)}),angular.isFunction(m.callback)&&m.callback(d.promise)};a.embedSWF(m.swfUrl,l,""+m.width,""+m.height,m.minFlashVersion,!1,m.flashvars,m.params,m.attributes,n)}}}}}]);